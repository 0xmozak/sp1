//! sp1-primitives contains types and functions that are used in both sp1-core and sp1-zkvm.
//! Because it is imported in the zkvm entrypoint, it should be kept minimal.

use lazy_static::lazy_static;
use p3_baby_bear::{BabyBear, DiffusionMatrixBabyBear};
use p3_field::AbstractField;
use p3_poseidon2::{Poseidon2, Poseidon2ExternalMatrixGeneral};

lazy_static! {
    // These constants are created by a RNG.

    // This will be compatible with a poseidon2 permutation config with
    // a state width of 16 and total rounds (both full and partial) of 30.
    pub static ref RC_16_30: [[BabyBear; 16]; 30] = [
        [
            BabyBear::from_wrapped_u32(2_110_014_213),
            BabyBear::from_wrapped_u32(3_964_964_605),
            BabyBear::from_wrapped_u32(2_190_662_774),
            BabyBear::from_wrapped_u32(2_732_996_483),
            BabyBear::from_wrapped_u32(640_767_983),
            BabyBear::from_wrapped_u32(3_403_899_136),
            BabyBear::from_wrapped_u32(1_716_033_721),
            BabyBear::from_wrapped_u32(1_606_702_601),
            BabyBear::from_wrapped_u32(3_759_873_288),
            BabyBear::from_wrapped_u32(1_466_015_491),
            BabyBear::from_wrapped_u32(1_498_308_946),
            BabyBear::from_wrapped_u32(2_844_375_094),
            BabyBear::from_wrapped_u32(3_042_463_841),
            BabyBear::from_wrapped_u32(1_969_905_919),
            BabyBear::from_wrapped_u32(4_109_944_726),
            BabyBear::from_wrapped_u32(3_925_048_366),
        ],
        [
            BabyBear::from_wrapped_u32(3_706_859_504),
            BabyBear::from_wrapped_u32(759_122_502),
            BabyBear::from_wrapped_u32(3_167_665_446),
            BabyBear::from_wrapped_u32(1_131_812_921),
            BabyBear::from_wrapped_u32(1_080_754_908),
            BabyBear::from_wrapped_u32(4_080_114_493),
            BabyBear::from_wrapped_u32(893_583_089),
            BabyBear::from_wrapped_u32(2_019_677_373),
            BabyBear::from_wrapped_u32(3_128_604_556),
            BabyBear::from_wrapped_u32(580_640_471),
            BabyBear::from_wrapped_u32(3_277_620_260),
            BabyBear::from_wrapped_u32(842_931_656),
            BabyBear::from_wrapped_u32(548_879_852),
            BabyBear::from_wrapped_u32(3_608_554_714),
            BabyBear::from_wrapped_u32(3_575_647_916),
            BabyBear::from_wrapped_u32(81_826_002),
        ],
        [
            BabyBear::from_wrapped_u32(4_289_086_263),
            BabyBear::from_wrapped_u32(1_563_933_798),
            BabyBear::from_wrapped_u32(1_440_025_885),
            BabyBear::from_wrapped_u32(184_445_025),
            BabyBear::from_wrapped_u32(2_598_651_360),
            BabyBear::from_wrapped_u32(1_396_647_410),
            BabyBear::from_wrapped_u32(1_575_877_922),
            BabyBear::from_wrapped_u32(3_303_853_401),
            BabyBear::from_wrapped_u32(137_125_468),
            BabyBear::from_wrapped_u32(765_010_148),
            BabyBear::from_wrapped_u32(633_675_867),
            BabyBear::from_wrapped_u32(2_037_803_363),
            BabyBear::from_wrapped_u32(2_573_389_828),
            BabyBear::from_wrapped_u32(1_895_729_703),
            BabyBear::from_wrapped_u32(541_515_871),
            BabyBear::from_wrapped_u32(1_783_382_863),
        ],
        [
            BabyBear::from_wrapped_u32(2_641_856_484),
            BabyBear::from_wrapped_u32(3_035_743_342),
            BabyBear::from_wrapped_u32(3_672_796_326),
            BabyBear::from_wrapped_u32(245_668_751),
            BabyBear::from_wrapped_u32(2_025_460_432),
            BabyBear::from_wrapped_u32(201_609_705),
            BabyBear::from_wrapped_u32(286_217_151),
            BabyBear::from_wrapped_u32(4_093_475_563),
            BabyBear::from_wrapped_u32(2_519_572_182),
            BabyBear::from_wrapped_u32(3_080_699_870),
            BabyBear::from_wrapped_u32(2_762_001_832),
            BabyBear::from_wrapped_u32(1_244_250_808),
            BabyBear::from_wrapped_u32(606_038_199),
            BabyBear::from_wrapped_u32(3_182_740_831),
            BabyBear::from_wrapped_u32(73_007_766),
            BabyBear::from_wrapped_u32(2_572_204_153),
        ],
        [
            BabyBear::from_wrapped_u32(1_196_780_786),
            BabyBear::from_wrapped_u32(3_447_394_443),
            BabyBear::from_wrapped_u32(747_167_305),
            BabyBear::from_wrapped_u32(2_968_073_607),
            BabyBear::from_wrapped_u32(1_053_214_930),
            BabyBear::from_wrapped_u32(1_074_411_832),
            BabyBear::from_wrapped_u32(4_016_794_508),
            BabyBear::from_wrapped_u32(1_570_312_929),
            BabyBear::from_wrapped_u32(113_576_933),
            BabyBear::from_wrapped_u32(4_042_581_186),
            BabyBear::from_wrapped_u32(3_634_515_733),
            BabyBear::from_wrapped_u32(1_032_701_597),
            BabyBear::from_wrapped_u32(2_364_839_308),
            BabyBear::from_wrapped_u32(3_840_286_918),
            BabyBear::from_wrapped_u32(888_378_655),
            BabyBear::from_wrapped_u32(2_520_191_583),
        ],
        [
            BabyBear::from_wrapped_u32(36_046_858),
            BabyBear::from_wrapped_u32(2_927_525_953),
            BabyBear::from_wrapped_u32(3_912_129_105),
            BabyBear::from_wrapped_u32(4_004_832_531),
            BabyBear::from_wrapped_u32(193_772_436),
            BabyBear::from_wrapped_u32(1_590_247_392),
            BabyBear::from_wrapped_u32(4_125_818_172),
            BabyBear::from_wrapped_u32(2_516_251_696),
            BabyBear::from_wrapped_u32(4_050_945_750),
            BabyBear::from_wrapped_u32(269_498_914),
            BabyBear::from_wrapped_u32(1_973_292_656),
            BabyBear::from_wrapped_u32(891_403_491),
            BabyBear::from_wrapped_u32(1_845_429_189),
            BabyBear::from_wrapped_u32(2_611_996_363),
            BabyBear::from_wrapped_u32(2_310_542_653),
            BabyBear::from_wrapped_u32(4_071_195_740),
        ],
        [
            BabyBear::from_wrapped_u32(3_505_307_391),
            BabyBear::from_wrapped_u32(786_445_290),
            BabyBear::from_wrapped_u32(3_815_313_971),
            BabyBear::from_wrapped_u32(1_111_591_756),
            BabyBear::from_wrapped_u32(4_233_279_834),
            BabyBear::from_wrapped_u32(2_775_453_034),
            BabyBear::from_wrapped_u32(1_991_257_625),
            BabyBear::from_wrapped_u32(2_940_505_809),
            BabyBear::from_wrapped_u32(2_751_316_206),
            BabyBear::from_wrapped_u32(1_028_870_679),
            BabyBear::from_wrapped_u32(1_282_466_273),
            BabyBear::from_wrapped_u32(1_059_053_371),
            BabyBear::from_wrapped_u32(834_521_354),
            BabyBear::from_wrapped_u32(138_721_483),
            BabyBear::from_wrapped_u32(3_100_410_803),
            BabyBear::from_wrapped_u32(3_843_128_331),
        ],
        [
            BabyBear::from_wrapped_u32(3_878_220_780),
            BabyBear::from_wrapped_u32(4_058_162_439),
            BabyBear::from_wrapped_u32(1_478_942_487),
            BabyBear::from_wrapped_u32(799_012_923),
            BabyBear::from_wrapped_u32(496_734_827),
            BabyBear::from_wrapped_u32(3_521_261_236),
            BabyBear::from_wrapped_u32(755_421_082),
            BabyBear::from_wrapped_u32(1_361_409_515),
            BabyBear::from_wrapped_u32(392_099_473),
            BabyBear::from_wrapped_u32(3_178_453_393),
            BabyBear::from_wrapped_u32(4_068_463_721),
            BabyBear::from_wrapped_u32(7_935_614),
            BabyBear::from_wrapped_u32(4_140_885_645),
            BabyBear::from_wrapped_u32(2_150_748_066),
            BabyBear::from_wrapped_u32(1_685_210_312),
            BabyBear::from_wrapped_u32(3_852_983_224),
        ],
        [
            BabyBear::from_wrapped_u32(2_896_943_075),
            BabyBear::from_wrapped_u32(3_087_590_927),
            BabyBear::from_wrapped_u32(992_175_959),
            BabyBear::from_wrapped_u32(970_216_228),
            BabyBear::from_wrapped_u32(3_473_630_090),
            BabyBear::from_wrapped_u32(3_899_670_400),
            BabyBear::from_wrapped_u32(3_603_388_822),
            BabyBear::from_wrapped_u32(2_633_488_197),
            BabyBear::from_wrapped_u32(2_479_406_964),
            BabyBear::from_wrapped_u32(2_420_952_999),
            BabyBear::from_wrapped_u32(1_852_516_800),
            BabyBear::from_wrapped_u32(4_253_075_697),
            BabyBear::from_wrapped_u32(979_699_862),
            BabyBear::from_wrapped_u32(1_163_403_191),
            BabyBear::from_wrapped_u32(1_608_599_874),
            BabyBear::from_wrapped_u32(3_056_104_448),
        ],
        [
            BabyBear::from_wrapped_u32(3_779_109_343),
            BabyBear::from_wrapped_u32(536_205_958),
            BabyBear::from_wrapped_u32(4_183_458_361),
            BabyBear::from_wrapped_u32(1_649_720_295),
            BabyBear::from_wrapped_u32(1_444_912_244),
            BabyBear::from_wrapped_u32(3_122_230_878),
            BabyBear::from_wrapped_u32(384_301_396),
            BabyBear::from_wrapped_u32(4_228_198_516),
            BabyBear::from_wrapped_u32(1_662_916_865),
            BabyBear::from_wrapped_u32(4_082_161_114),
            BabyBear::from_wrapped_u32(2_121_897_314),
            BabyBear::from_wrapped_u32(1_706_239_958),
            BabyBear::from_wrapped_u32(4_166_959_388),
            BabyBear::from_wrapped_u32(1_626_054_781),
            BabyBear::from_wrapped_u32(3_005_858_978),
            BabyBear::from_wrapped_u32(1_431_907_253),
        ],
        [
            BabyBear::from_wrapped_u32(1_418_914_503),
            BabyBear::from_wrapped_u32(1_365_856_753),
            BabyBear::from_wrapped_u32(3_942_715_745),
            BabyBear::from_wrapped_u32(1_429_155_552),
            BabyBear::from_wrapped_u32(3_545_642_795),
            BabyBear::from_wrapped_u32(3_772_474_257),
            BabyBear::from_wrapped_u32(1_621_094_396),
            BabyBear::from_wrapped_u32(2_154_399_145),
            BabyBear::from_wrapped_u32(826_697_382),
            BabyBear::from_wrapped_u32(1_700_781_391),
            BabyBear::from_wrapped_u32(3_539_164_324),
            BabyBear::from_wrapped_u32(652_815_039),
            BabyBear::from_wrapped_u32(442_484_755),
            BabyBear::from_wrapped_u32(2_055_299_391),
            BabyBear::from_wrapped_u32(1_064_289_978),
            BabyBear::from_wrapped_u32(1_152_335_780),
        ],
        [
            BabyBear::from_wrapped_u32(3_417_648_695),
            BabyBear::from_wrapped_u32(186_040_114),
            BabyBear::from_wrapped_u32(3_475_580_573),
            BabyBear::from_wrapped_u32(2_113_941_250),
            BabyBear::from_wrapped_u32(1_779_573_826),
            BabyBear::from_wrapped_u32(1_573_808_590),
            BabyBear::from_wrapped_u32(3_235_694_804),
            BabyBear::from_wrapped_u32(2_922_195_281),
            BabyBear::from_wrapped_u32(1_119_462_702),
            BabyBear::from_wrapped_u32(3_688_305_521),
            BabyBear::from_wrapped_u32(1_849_567_013),
            BabyBear::from_wrapped_u32(667_446_787),
            BabyBear::from_wrapped_u32(753_897_224),
            BabyBear::from_wrapped_u32(1_896_396_780),
            BabyBear::from_wrapped_u32(3_143_026_334),
            BabyBear::from_wrapped_u32(3_829_603_876),
        ],
        [
            BabyBear::from_wrapped_u32(859_661_334),
            BabyBear::from_wrapped_u32(3_898_844_357),
            BabyBear::from_wrapped_u32(180_258_337),
            BabyBear::from_wrapped_u32(2_321_867_017),
            BabyBear::from_wrapped_u32(3_599_002_504),
            BabyBear::from_wrapped_u32(2_886_782_421),
            BabyBear::from_wrapped_u32(3_038_299_378),
            BabyBear::from_wrapped_u32(1_035_366_250),
            BabyBear::from_wrapped_u32(2_038_912_197),
            BabyBear::from_wrapped_u32(2_920_174_523),
            BabyBear::from_wrapped_u32(1_277_696_101),
            BabyBear::from_wrapped_u32(2_785_700_290),
            BabyBear::from_wrapped_u32(3_806_504_335),
            BabyBear::from_wrapped_u32(3_518_858_933),
            BabyBear::from_wrapped_u32(654_843_672),
            BabyBear::from_wrapped_u32(2_127_120_275),
        ],
        [
            BabyBear::from_wrapped_u32(1_548_195_514),
            BabyBear::from_wrapped_u32(2_378_056_027),
            BabyBear::from_wrapped_u32(390_914_568),
            BabyBear::from_wrapped_u32(1_472_049_779),
            BabyBear::from_wrapped_u32(1_552_596_765),
            BabyBear::from_wrapped_u32(1_905_886_441),
            BabyBear::from_wrapped_u32(1_611_959_354),
            BabyBear::from_wrapped_u32(3_653_263_304),
            BabyBear::from_wrapped_u32(3_423_946_386),
            BabyBear::from_wrapped_u32(340_857_935),
            BabyBear::from_wrapped_u32(2_208_879_480),
            BabyBear::from_wrapped_u32(139_364_268),
            BabyBear::from_wrapped_u32(3_447_281_773),
            BabyBear::from_wrapped_u32(3_777_813_707),
            BabyBear::from_wrapped_u32(55_640_413),
            BabyBear::from_wrapped_u32(4_101_901_741),
        ],
        [
            BabyBear::from_wrapped_u32(104_929_687),
            BabyBear::from_wrapped_u32(1_459_980_974),
            BabyBear::from_wrapped_u32(1_831_234_737),
            BabyBear::from_wrapped_u32(457_139_004),
            BabyBear::from_wrapped_u32(2_581_487_628),
            BabyBear::from_wrapped_u32(2_112_044_563),
            BabyBear::from_wrapped_u32(3_567_013_861),
            BabyBear::from_wrapped_u32(2_792_004_347),
            BabyBear::from_wrapped_u32(576_325_418),
            BabyBear::from_wrapped_u32(41_126_132),
            BabyBear::from_wrapped_u32(2_713_562_324),
            BabyBear::from_wrapped_u32(151_213_722),
            BabyBear::from_wrapped_u32(2_891_185_935),
            BabyBear::from_wrapped_u32(546_846_420),
            BabyBear::from_wrapped_u32(2_939_794_919),
            BabyBear::from_wrapped_u32(2_543_469_905)
        ],
        [
            BabyBear::from_wrapped_u32(2_191_909_784),
            BabyBear::from_wrapped_u32(3_315_138_460),
            BabyBear::from_wrapped_u32(530_414_574),
            BabyBear::from_wrapped_u32(1_242_280_418),
            BabyBear::from_wrapped_u32(1_211_740_715),
            BabyBear::from_wrapped_u32(3_993_672_165),
            BabyBear::from_wrapped_u32(2_505_083_323),
            BabyBear::from_wrapped_u32(3_845_798_801),
            BabyBear::from_wrapped_u32(538_768_466),
            BabyBear::from_wrapped_u32(2_063_567_560),
            BabyBear::from_wrapped_u32(3_366_148_274),
            BabyBear::from_wrapped_u32(1_449_831_887),
            BabyBear::from_wrapped_u32(2_408_012_466),
            BabyBear::from_wrapped_u32(294_726_285),
            BabyBear::from_wrapped_u32(3_943_435_493),
            BabyBear::from_wrapped_u32(924_016_661),
        ],
        [
            BabyBear::from_wrapped_u32(3_633_138_367),
            BabyBear::from_wrapped_u32(3_222_789_372),
            BabyBear::from_wrapped_u32(809_116_305),
            BabyBear::from_wrapped_u32(30_100_013),
            BabyBear::from_wrapped_u32(2_655_172_876),
            BabyBear::from_wrapped_u32(2_564_247_117),
            BabyBear::from_wrapped_u32(2_478_649_732),
            BabyBear::from_wrapped_u32(4_113_689_151),
            BabyBear::from_wrapped_u32(4_120_146_082),
            BabyBear::from_wrapped_u32(2_512_308_515),
            BabyBear::from_wrapped_u32(650_406_041),
            BabyBear::from_wrapped_u32(4_240_012_393),
            BabyBear::from_wrapped_u32(2_683_508_708),
            BabyBear::from_wrapped_u32(951_073_977),
            BabyBear::from_wrapped_u32(3_460_081_988),
            BabyBear::from_wrapped_u32(339_124_269),
        ],
        [
            BabyBear::from_wrapped_u32(130_182_653),
            BabyBear::from_wrapped_u32(2_755_946_749),
            BabyBear::from_wrapped_u32(542_600_513),
            BabyBear::from_wrapped_u32(2_816_103_022),
            BabyBear::from_wrapped_u32(1_931_786_340),
            BabyBear::from_wrapped_u32(2_044_470_840),
            BabyBear::from_wrapped_u32(1_709_908_013),
            BabyBear::from_wrapped_u32(2_938_369_043),
            BabyBear::from_wrapped_u32(3_640_399_693),
            BabyBear::from_wrapped_u32(1_374_470_239),
            BabyBear::from_wrapped_u32(2_191_149_676),
            BabyBear::from_wrapped_u32(2_637_495_682),
            BabyBear::from_wrapped_u32(4_236_394_040),
            BabyBear::from_wrapped_u32(2_289_358_846),
            BabyBear::from_wrapped_u32(3_833_368_530),
            BabyBear::from_wrapped_u32(974_546_524),
        ],
        [
            BabyBear::from_wrapped_u32(3_306_659_113),
            BabyBear::from_wrapped_u32(2_234_814_261),
            BabyBear::from_wrapped_u32(1_188_782_305),
            BabyBear::from_wrapped_u32(223_782_844),
            BabyBear::from_wrapped_u32(2_248_980_567),
            BabyBear::from_wrapped_u32(2_309_786_141),
            BabyBear::from_wrapped_u32(2_023_401_627),
            BabyBear::from_wrapped_u32(3_278_877_413),
            BabyBear::from_wrapped_u32(2_022_138_149),
            BabyBear::from_wrapped_u32(575_851_471),
            BabyBear::from_wrapped_u32(1_612_560_780),
            BabyBear::from_wrapped_u32(3_926_656_936),
            BabyBear::from_wrapped_u32(3_318_548_977),
            BabyBear::from_wrapped_u32(2_591_863_678),
            BabyBear::from_wrapped_u32(188_109_355),
            BabyBear::from_wrapped_u32(4_217_723_909),
        ],
        [
            BabyBear::from_wrapped_u32(1_564_209_905),
            BabyBear::from_wrapped_u32(2_154_197_895),
            BabyBear::from_wrapped_u32(2_459_687_029),
            BabyBear::from_wrapped_u32(2_870_634_489),
            BabyBear::from_wrapped_u32(1_375_012_945),
            BabyBear::from_wrapped_u32(1_529_454_825),
            BabyBear::from_wrapped_u32(306_140_690),
            BabyBear::from_wrapped_u32(2_855_578_299),
            BabyBear::from_wrapped_u32(1_246_997_295),
            BabyBear::from_wrapped_u32(3_024_298_763),
            BabyBear::from_wrapped_u32(1_915_270_363),
            BabyBear::from_wrapped_u32(1_218_245_412),
            BabyBear::from_wrapped_u32(2_479_314_020),
            BabyBear::from_wrapped_u32(2_989_827_755),
            BabyBear::from_wrapped_u32(814_378_556),
            BabyBear::from_wrapped_u32(4_039_775_921),
        ],
        [
            BabyBear::from_wrapped_u32(1_165_280_628),
            BabyBear::from_wrapped_u32(1_203_983_801),
            BabyBear::from_wrapped_u32(3_814_740_033),
            BabyBear::from_wrapped_u32(1_919_627_044),
            BabyBear::from_wrapped_u32(600_240_215),
            BabyBear::from_wrapped_u32(773_269_071),
            BabyBear::from_wrapped_u32(486_685_186),
            BabyBear::from_wrapped_u32(4_254_048_810),
            BabyBear::from_wrapped_u32(1_415_023_565),
            BabyBear::from_wrapped_u32(502_840_102),
            BabyBear::from_wrapped_u32(4_225_648_358),
            BabyBear::from_wrapped_u32(510_217_063),
            BabyBear::from_wrapped_u32(166_444_818),
            BabyBear::from_wrapped_u32(1_430_745_893),
            BabyBear::from_wrapped_u32(1_376_516_190),
            BabyBear::from_wrapped_u32(1_775_891_321),
        ],
        [
            BabyBear::from_wrapped_u32(1_170_945_922),
            BabyBear::from_wrapped_u32(1_105_391_877),
            BabyBear::from_wrapped_u32(261_536_467),
            BabyBear::from_wrapped_u32(1_401_687_994),
            BabyBear::from_wrapped_u32(1_022_529_847),
            BabyBear::from_wrapped_u32(2_476_446_456),
            BabyBear::from_wrapped_u32(2_603_844_878),
            BabyBear::from_wrapped_u32(3_706_336_043),
            BabyBear::from_wrapped_u32(3_463_053_714),
            BabyBear::from_wrapped_u32(1_509_644_517),
            BabyBear::from_wrapped_u32(588_552_318),
            BabyBear::from_wrapped_u32(65_252_581),
            BabyBear::from_wrapped_u32(3_696_502_656),
            BabyBear::from_wrapped_u32(2_183_330_763),
            BabyBear::from_wrapped_u32(3_664_021_233),
            BabyBear::from_wrapped_u32(1_643_809_916),
        ],
        [
            BabyBear::from_wrapped_u32(2_922_875_898),
            BabyBear::from_wrapped_u32(3_740_690_643),
            BabyBear::from_wrapped_u32(3_932_461_140),
            BabyBear::from_wrapped_u32(161_156_271),
            BabyBear::from_wrapped_u32(2_619_943_483),
            BabyBear::from_wrapped_u32(4_077_039_509),
            BabyBear::from_wrapped_u32(2_921_201_703),
            BabyBear::from_wrapped_u32(2_085_619_718),
            BabyBear::from_wrapped_u32(2_065_264_646),
            BabyBear::from_wrapped_u32(2_615_693_812),
            BabyBear::from_wrapped_u32(3_116_555_433),
            BabyBear::from_wrapped_u32(246_100_007),
            BabyBear::from_wrapped_u32(4_281_387_154),
            BabyBear::from_wrapped_u32(4_046_141_001),
            BabyBear::from_wrapped_u32(4_027_749_321),
            BabyBear::from_wrapped_u32(111_611_860),
        ],
        [
            BabyBear::from_wrapped_u32(2_066_954_820),
            BabyBear::from_wrapped_u32(2_502_099_969),
            BabyBear::from_wrapped_u32(2_915_053_115),
            BabyBear::from_wrapped_u32(2_362_518_586),
            BabyBear::from_wrapped_u32(366_091_708),
            BabyBear::from_wrapped_u32(2_083_204_932),
            BabyBear::from_wrapped_u32(4_138_385_632),
            BabyBear::from_wrapped_u32(3_195_157_567),
            BabyBear::from_wrapped_u32(1_318_086_382),
            BabyBear::from_wrapped_u32(521_723_799),
            BabyBear::from_wrapped_u32(702_443_405),
            BabyBear::from_wrapped_u32(2_507_670_985),
            BabyBear::from_wrapped_u32(1_760_347_557),
            BabyBear::from_wrapped_u32(2_631_999_893),
            BabyBear::from_wrapped_u32(1_672_737_554),
            BabyBear::from_wrapped_u32(1_060_867_760),
        ],
        [
            BabyBear::from_wrapped_u32(2_359_801_781),
            BabyBear::from_wrapped_u32(2_800_231_467),
            BabyBear::from_wrapped_u32(3_010_357_035),
            BabyBear::from_wrapped_u32(1_035_997_899),
            BabyBear::from_wrapped_u32(1_210_110_952),
            BabyBear::from_wrapped_u32(1_018_506_770),
            BabyBear::from_wrapped_u32(2_799_468_177),
            BabyBear::from_wrapped_u32(1_479_380_761),
            BabyBear::from_wrapped_u32(1_536_021_911),
            BabyBear::from_wrapped_u32(358_993_854),
            BabyBear::from_wrapped_u32(579_904_113),
            BabyBear::from_wrapped_u32(3_432_144_800),
            BabyBear::from_wrapped_u32(3_625_515_809),
            BabyBear::from_wrapped_u32(199_241_497),
            BabyBear::from_wrapped_u32(4_058_304_109),
            BabyBear::from_wrapped_u32(2_590_164_234),
        ],
        [
            BabyBear::from_wrapped_u32(1_688_530_738),
            BabyBear::from_wrapped_u32(1_580_733_335),
            BabyBear::from_wrapped_u32(2_443_981_517),
            BabyBear::from_wrapped_u32(2_206_270_565),
            BabyBear::from_wrapped_u32(2_780_074_229),
            BabyBear::from_wrapped_u32(2_628_739_677),
            BabyBear::from_wrapped_u32(2_940_123_659),
            BabyBear::from_wrapped_u32(4_145_206_827),
            BabyBear::from_wrapped_u32(3_572_278_009),
            BabyBear::from_wrapped_u32(2_779_607_509),
            BabyBear::from_wrapped_u32(1_098_718_697),
            BabyBear::from_wrapped_u32(1_424_913_749),
            BabyBear::from_wrapped_u32(2_224_415_875),
            BabyBear::from_wrapped_u32(1_108_922_178),
            BabyBear::from_wrapped_u32(3_646_272_562),
            BabyBear::from_wrapped_u32(3_935_186_184),
        ],
        [
            BabyBear::from_wrapped_u32(820_046_587),
            BabyBear::from_wrapped_u32(1_393_386_250),
            BabyBear::from_wrapped_u32(2_665_818_575),
            BabyBear::from_wrapped_u32(2_231_782_019),
            BabyBear::from_wrapped_u32(672_377_010),
            BabyBear::from_wrapped_u32(1_920_315_467),
            BabyBear::from_wrapped_u32(1_913_164_407),
            BabyBear::from_wrapped_u32(2_029_526_876),
            BabyBear::from_wrapped_u32(2_629_271_820),
            BabyBear::from_wrapped_u32(384_320_012),
            BabyBear::from_wrapped_u32(4_112_320_585),
            BabyBear::from_wrapped_u32(3_131_824_773),
            BabyBear::from_wrapped_u32(2_347_818_197),
            BabyBear::from_wrapped_u32(2_220_997_386),
            BabyBear::from_wrapped_u32(1_772_368_609),
            BabyBear::from_wrapped_u32(2_579_960_095),
        ],
        [
            BabyBear::from_wrapped_u32(3_544_930_873),
            BabyBear::from_wrapped_u32(225_847_443),
            BabyBear::from_wrapped_u32(3_070_082_278),
            BabyBear::from_wrapped_u32(95_643_305),
            BabyBear::from_wrapped_u32(3_438_572_042),
            BabyBear::from_wrapped_u32(3_312_856_509),
            BabyBear::from_wrapped_u32(615_850_007),
            BabyBear::from_wrapped_u32(1_863_868_773),
            BabyBear::from_wrapped_u32(803_582_265),
            BabyBear::from_wrapped_u32(3_461_976_859),
            BabyBear::from_wrapped_u32(2_903_025_799),
            BabyBear::from_wrapped_u32(1_482_092_434),
            BabyBear::from_wrapped_u32(3_902_972_499),
            BabyBear::from_wrapped_u32(3_872_341_868),
            BabyBear::from_wrapped_u32(1_530_411_808),
            BabyBear::from_wrapped_u32(2_214_923_584),
        ],
        [
            BabyBear::from_wrapped_u32(3_118_792_481),
            BabyBear::from_wrapped_u32(2_241_076_515),
            BabyBear::from_wrapped_u32(3_983_669_831),
            BabyBear::from_wrapped_u32(3_180_915_147),
            BabyBear::from_wrapped_u32(3_838_626_501),
            BabyBear::from_wrapped_u32(1_921_630_011),
            BabyBear::from_wrapped_u32(3_415_351_771),
            BabyBear::from_wrapped_u32(2_249_953_859),
            BabyBear::from_wrapped_u32(3_755_081_630),
            BabyBear::from_wrapped_u32(486_327_260),
            BabyBear::from_wrapped_u32(1_227_575_720),
            BabyBear::from_wrapped_u32(3_643_869_379),
            BabyBear::from_wrapped_u32(2_982_026_073),
            BabyBear::from_wrapped_u32(2_466_043_731),
            BabyBear::from_wrapped_u32(1_982_634_375),
            BabyBear::from_wrapped_u32(3_769_609_014),
        ],
        [
            BabyBear::from_wrapped_u32(2_195_455_495),
            BabyBear::from_wrapped_u32(2_596_863_283),
            BabyBear::from_wrapped_u32(4_244_994_973),
            BabyBear::from_wrapped_u32(1_983_609_348),
            BabyBear::from_wrapped_u32(4_019_674_395),
            BabyBear::from_wrapped_u32(3_469_982_031),
            BabyBear::from_wrapped_u32(1_458_697_570),
            BabyBear::from_wrapped_u32(1_593_516_217),
            BabyBear::from_wrapped_u32(1_963_896_497),
            BabyBear::from_wrapped_u32(3_115_309_118),
            BabyBear::from_wrapped_u32(1_659_132_465),
            BabyBear::from_wrapped_u32(2_536_770_756),
            BabyBear::from_wrapped_u32(3_059_294_171),
            BabyBear::from_wrapped_u32(2_618_031_334),
            BabyBear::from_wrapped_u32(2_040_903_247),
            BabyBear::from_wrapped_u32(3_799_795_076),
        ]
    ];


    pub static ref RC_16_30_U32: [[u32; 16]; 30] = [
        [
            (2_110_014_213),
            (3_964_964_605),
            (2_190_662_774),
            (2_732_996_483),
            (640_767_983),
            (3_403_899_136),
            (1_716_033_721),
            (1_606_702_601),
            (3_759_873_288),
            (1_466_015_491),
            (1_498_308_946),
            (2_844_375_094),
            (3_042_463_841),
            (1_969_905_919),
            (4_109_944_726),
            (3_925_048_366),
        ],
        [
            (3_706_859_504),
            (759_122_502),
            (3_167_665_446),
            (1_131_812_921),
            (1_080_754_908),
            (4_080_114_493),
            (893_583_089),
            (2_019_677_373),
            (3_128_604_556),
            (580_640_471),
            (3_277_620_260),
            (842_931_656),
            (548_879_852),
            (3_608_554_714),
            (3_575_647_916),
            (81_826_002),
        ],
        [
            (4_289_086_263),
            (1_563_933_798),
            (1_440_025_885),
            (184_445_025),
            (2_598_651_360),
            (1_396_647_410),
            (1_575_877_922),
            (3_303_853_401),
            (137_125_468),
            (765_010_148),
            (633_675_867),
            (2_037_803_363),
            (2_573_389_828),
            (1_895_729_703),
            (541_515_871),
            (1_783_382_863),
        ],
        [
            (2_641_856_484),
            (3_035_743_342),
            (3_672_796_326),
            (245_668_751),
            (2_025_460_432),
            (201_609_705),
            (286_217_151),
            (4_093_475_563),
            (2_519_572_182),
            (3_080_699_870),
            (2_762_001_832),
            (1_244_250_808),
            (606_038_199),
            (3_182_740_831),
            (73_007_766),
            (2_572_204_153),
        ],
        [
            (1_196_780_786),
            (3_447_394_443),
            (747_167_305),
            (2_968_073_607),
            (1_053_214_930),
            (1_074_411_832),
            (4_016_794_508),
            (1_570_312_929),
            (113_576_933),
            (4_042_581_186),
            (3_634_515_733),
            (1_032_701_597),
            (2_364_839_308),
            (3_840_286_918),
            (888_378_655),
            (2_520_191_583),
        ],
        [
            (36_046_858),
            (2_927_525_953),
            (3_912_129_105),
            (4_004_832_531),
            (193_772_436),
            (1_590_247_392),
            (4_125_818_172),
            (2_516_251_696),
            (4_050_945_750),
            (269_498_914),
            (1_973_292_656),
            (891_403_491),
            (1_845_429_189),
            (2_611_996_363),
            (2_310_542_653),
            (4_071_195_740),
        ],
        [
            (3_505_307_391),
            (786_445_290),
            (3_815_313_971),
            (1_111_591_756),
            (4_233_279_834),
            (2_775_453_034),
            (1_991_257_625),
            (2_940_505_809),
            (2_751_316_206),
            (1_028_870_679),
            (1_282_466_273),
            (1_059_053_371),
            (834_521_354),
            (138_721_483),
            (3_100_410_803),
            (3_843_128_331),
        ],
        [
            (3_878_220_780),
            (4_058_162_439),
            (1_478_942_487),
            (799_012_923),
            (496_734_827),
            (3_521_261_236),
            (755_421_082),
            (1_361_409_515),
            (392_099_473),
            (3_178_453_393),
            (4_068_463_721),
            (7_935_614),
            (4_140_885_645),
            (2_150_748_066),
            (1_685_210_312),
            (3_852_983_224),
        ],
        [
            (2_896_943_075),
            (3_087_590_927),
            (992_175_959),
            (970_216_228),
            (3_473_630_090),
            (3_899_670_400),
            (3_603_388_822),
            (2_633_488_197),
            (2_479_406_964),
            (2_420_952_999),
            (1_852_516_800),
            (4_253_075_697),
            (979_699_862),
            (1_163_403_191),
            (1_608_599_874),
            (3_056_104_448),
        ],
        [
            (3_779_109_343),
            (536_205_958),
            (4_183_458_361),
            (1_649_720_295),
            (1_444_912_244),
            (3_122_230_878),
            (384_301_396),
            (4_228_198_516),
            (1_662_916_865),
            (4_082_161_114),
            (2_121_897_314),
            (1_706_239_958),
            (4_166_959_388),
            (1_626_054_781),
            (3_005_858_978),
            (1_431_907_253),
        ],
        [
            (1_418_914_503),
            (1_365_856_753),
            (3_942_715_745),
            (1_429_155_552),
            (3_545_642_795),
            (3_772_474_257),
            (1_621_094_396),
            (2_154_399_145),
            (826_697_382),
            (1_700_781_391),
            (3_539_164_324),
            (652_815_039),
            (442_484_755),
            (2_055_299_391),
            (1_064_289_978),
            (1_152_335_780),
        ],
        [
            (3_417_648_695),
            (186_040_114),
            (3_475_580_573),
            (2_113_941_250),
            (1_779_573_826),
            (1_573_808_590),
            (3_235_694_804),
            (2_922_195_281),
            (1_119_462_702),
            (3_688_305_521),
            (1_849_567_013),
            (667_446_787),
            (753_897_224),
            (1_896_396_780),
            (3_143_026_334),
            (3_829_603_876),
        ],
        [
            (859_661_334),
            (3_898_844_357),
            (180_258_337),
            (2_321_867_017),
            (3_599_002_504),
            (2_886_782_421),
            (3_038_299_378),
            (1_035_366_250),
            (2_038_912_197),
            (2_920_174_523),
            (1_277_696_101),
            (2_785_700_290),
            (3_806_504_335),
            (3_518_858_933),
            (654_843_672),
            (2_127_120_275),
        ],
        [
            (1_548_195_514),
            (2_378_056_027),
            (390_914_568),
            (1_472_049_779),
            (1_552_596_765),
            (1_905_886_441),
            (1_611_959_354),
            (3_653_263_304),
            (3_423_946_386),
            (340_857_935),
            (2_208_879_480),
            (139_364_268),
            (3_447_281_773),
            (3_777_813_707),
            (55_640_413),
            (4_101_901_741),
        ],
        [
            (104_929_687),
            (1_459_980_974),
            (1_831_234_737),
            (457_139_004),
            (2_581_487_628),
            (2_112_044_563),
            (3_567_013_861),
            (2_792_004_347),
            (576_325_418),
            (41_126_132),
            (2_713_562_324),
            (151_213_722),
            (2_891_185_935),
            (546_846_420),
            (2_939_794_919),
            (2_543_469_905)
        ],
        [
            (2_191_909_784),
            (3_315_138_460),
            (530_414_574),
            (1_242_280_418),
            (1_211_740_715),
            (3_993_672_165),
            (2_505_083_323),
            (3_845_798_801),
            (538_768_466),
            (2_063_567_560),
            (3_366_148_274),
            (1_449_831_887),
            (2_408_012_466),
            (294_726_285),
            (3_943_435_493),
            (924_016_661),
        ],
        [
            (3_633_138_367),
            (3_222_789_372),
            (809_116_305),
            (30_100_013),
            (2_655_172_876),
            (2_564_247_117),
            (2_478_649_732),
            (4_113_689_151),
            (4_120_146_082),
            (2_512_308_515),
            (650_406_041),
            (4_240_012_393),
            (2_683_508_708),
            (951_073_977),
            (3_460_081_988),
            (339_124_269),
        ],
        [
            (130_182_653),
            (2_755_946_749),
            (542_600_513),
            (2_816_103_022),
            (1_931_786_340),
            (2_044_470_840),
            (1_709_908_013),
            (2_938_369_043),
            (3_640_399_693),
            (1_374_470_239),
            (2_191_149_676),
            (2_637_495_682),
            (4_236_394_040),
            (2_289_358_846),
            (3_833_368_530),
            (974_546_524),
        ],
        [
            (3_306_659_113),
            (2_234_814_261),
            (1_188_782_305),
            (223_782_844),
            (2_248_980_567),
            (2_309_786_141),
            (2_023_401_627),
            (3_278_877_413),
            (2_022_138_149),
            (575_851_471),
            (1_612_560_780),
            (3_926_656_936),
            (3_318_548_977),
            (2_591_863_678),
            (188_109_355),
            (4_217_723_909),
        ],
        [
            (1_564_209_905),
            (2_154_197_895),
            (2_459_687_029),
            (2_870_634_489),
            (1_375_012_945),
            (1_529_454_825),
            (306_140_690),
            (2_855_578_299),
            (1_246_997_295),
            (3_024_298_763),
            (1_915_270_363),
            (1_218_245_412),
            (2_479_314_020),
            (2_989_827_755),
            (814_378_556),
            (4_039_775_921),
        ],
        [
            (1_165_280_628),
            (1_203_983_801),
            (3_814_740_033),
            (1_919_627_044),
            (600_240_215),
            (773_269_071),
            (486_685_186),
            (4_254_048_810),
            (1_415_023_565),
            (502_840_102),
            (4_225_648_358),
            (510_217_063),
            (166_444_818),
            (1_430_745_893),
            (1_376_516_190),
            (1_775_891_321),
        ],
        [
            (1_170_945_922),
            (1_105_391_877),
            (261_536_467),
            (1_401_687_994),
            (1_022_529_847),
            (2_476_446_456),
            (2_603_844_878),
            (3_706_336_043),
            (3_463_053_714),
            (1_509_644_517),
            (588_552_318),
            (65_252_581),
            (3_696_502_656),
            (2_183_330_763),
            (3_664_021_233),
            (1_643_809_916),
        ],
        [
            (2_922_875_898),
            (3_740_690_643),
            (3_932_461_140),
            (161_156_271),
            (2_619_943_483),
            (4_077_039_509),
            (2_921_201_703),
            (2_085_619_718),
            (2_065_264_646),
            (2_615_693_812),
            (3_116_555_433),
            (246_100_007),
            (4_281_387_154),
            (4_046_141_001),
            (4_027_749_321),
            (111_611_860),
        ],
        [
            (2_066_954_820),
            (2_502_099_969),
            (2_915_053_115),
            (2_362_518_586),
            (366_091_708),
            (2_083_204_932),
            (4_138_385_632),
            (3_195_157_567),
            (1_318_086_382),
            (521_723_799),
            (702_443_405),
            (2_507_670_985),
            (1_760_347_557),
            (2_631_999_893),
            (1_672_737_554),
            (1_060_867_760),
        ],
        [
            (2_359_801_781),
            (2_800_231_467),
            (3_010_357_035),
            (1_035_997_899),
            (1_210_110_952),
            (1_018_506_770),
            (2_799_468_177),
            (1_479_380_761),
            (1_536_021_911),
            (358_993_854),
            (579_904_113),
            (3_432_144_800),
            (3_625_515_809),
            (199_241_497),
            (4_058_304_109),
            (2_590_164_234),
        ],
        [
            (1_688_530_738),
            (1_580_733_335),
            (2_443_981_517),
            (2_206_270_565),
            (2_780_074_229),
            (2_628_739_677),
            (2_940_123_659),
            (4_145_206_827),
            (3_572_278_009),
            (2_779_607_509),
            (1_098_718_697),
            (1_424_913_749),
            (2_224_415_875),
            (1_108_922_178),
            (3_646_272_562),
            (3_935_186_184),
        ],
        [
            (820_046_587),
            (1_393_386_250),
            (2_665_818_575),
            (2_231_782_019),
            (672_377_010),
            (1_920_315_467),
            (1_913_164_407),
            (2_029_526_876),
            (2_629_271_820),
            (384_320_012),
            (4_112_320_585),
            (3_131_824_773),
            (2_347_818_197),
            (2_220_997_386),
            (1_772_368_609),
            (2_579_960_095),
        ],
        [
            (3_544_930_873),
            (225_847_443),
            (3_070_082_278),
            (95_643_305),
            (3_438_572_042),
            (3_312_856_509),
            (615_850_007),
            (1_863_868_773),
            (803_582_265),
            (3_461_976_859),
            (2_903_025_799),
            (1_482_092_434),
            (3_902_972_499),
            (3_872_341_868),
            (1_530_411_808),
            (2_214_923_584),
        ],
        [
            (3_118_792_481),
            (2_241_076_515),
            (3_983_669_831),
            (3_180_915_147),
            (3_838_626_501),
            (1_921_630_011),
            (3_415_351_771),
            (2_249_953_859),
            (3_755_081_630),
            (486_327_260),
            (1_227_575_720),
            (3_643_869_379),
            (2_982_026_073),
            (2_466_043_731),
            (1_982_634_375),
            (3_769_609_014),
        ],
        [
            (2_195_455_495),
            (2_596_863_283),
            (4_244_994_973),
            (1_983_609_348),
            (4_019_674_395),
            (3_469_982_031),
            (1_458_697_570),
            (1_593_516_217),
            (1_963_896_497),
            (3_115_309_118),
            (1_659_132_465),
            (2_536_770_756),
            (3_059_294_171),
            (2_618_031_334),
            (2_040_903_247),
            (3_799_795_076),
        ]
    ];
}

#[must_use]
pub fn poseidon2_init(
) -> Poseidon2<BabyBear, Poseidon2ExternalMatrixGeneral, DiffusionMatrixBabyBear, 16, 7> {
    const ROUNDS_F: usize = 8;
    const ROUNDS_P: usize = 13;
    let mut round_constants = RC_16_30.to_vec();
    let internal_start = ROUNDS_F / 2;
    let internal_end = (ROUNDS_F / 2) + ROUNDS_P;
    let internal_round_constants = round_constants
        .drain(internal_start..internal_end)
        .map(|vec| vec[0])
        .collect::<Vec<_>>();
    let external_round_constants = round_constants;
    Poseidon2::new(
        ROUNDS_F,
        external_round_constants,
        Poseidon2ExternalMatrixGeneral,
        ROUNDS_P,
        internal_round_constants,
        DiffusionMatrixBabyBear,
    )
}

use p3_symmetric::{CryptographicHasher, PaddingFreeSponge};

#[must_use]
pub fn poseidon2_hash(input: Vec<BabyBear>) -> [BabyBear; 8] {
    POSEIDON2_HASHER.hash_iter(input)
}

#[must_use]
pub fn poseidon2_hasher() -> PaddingFreeSponge<
    Poseidon2<BabyBear, Poseidon2ExternalMatrixGeneral, DiffusionMatrixBabyBear, 16, 7>,
    16,
    8,
    8,
> {
    let hasher = poseidon2_init();
    PaddingFreeSponge::<
        Poseidon2<BabyBear, Poseidon2ExternalMatrixGeneral, DiffusionMatrixBabyBear, 16, 7>,
        16,
        8,
        8,
    >::new(hasher)
}

lazy_static! {
    pub static ref POSEIDON2_HASHER: PaddingFreeSponge::<
        Poseidon2<BabyBear, Poseidon2ExternalMatrixGeneral, DiffusionMatrixBabyBear, 16, 7>,
        16,
        8,
        8,
    > = poseidon2_hasher();
}

/// Append a single deferred proof to a hash chain of deferred proofs.
#[must_use]
pub fn hash_deferred_proof(
    prev_digest: &[BabyBear; 8],
    vk_digest: &[BabyBear; 8],
    pv_digest: &[BabyBear; 32],
) -> [BabyBear; 8] {
    let mut inputs = Vec::with_capacity(48);
    inputs.extend_from_slice(prev_digest);
    inputs.extend_from_slice(vk_digest);
    inputs.extend_from_slice(pv_digest);
    poseidon2_hash(inputs.clone())
}
